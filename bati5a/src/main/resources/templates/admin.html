<!DOCTYPE html>
<html lang="de" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard â€“ Bati5a</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
</head>

<body class="bg-light">

    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
            <div class="container-fluid">
                <a href="/" class="navbar-brand d-flex align-items-center">
                    <img src="/images/HHU_Logo.svg.png" alt="HHU Logo" height="50" class="bg-white rounded p-1 me-2">
                    <span>Bati5a Admin</span>
                </a>
                <div class="collapse navbar-collapse justify-content-end">
                    <ul class="navbar-nav">
                        <li class="nav-item"><a class="nav-link" href="/topics">Topics</a></li>
                        <li class="nav-item"><a class="nav-link" href="/profile">Mein Profil</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main class="container py-5">
        <div class="row">
            <div class="col-12">
                <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                    <span th:text="${error}">Fehler!</span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>

                <div th:if="${message}" class="alert alert-success alert-dismissible fade show" role="alert">
                    <span th:text="${message}">Erfolg!</span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>

                <!-- Create Profile Card -->
                <div class="card shadow-sm border-0 rounded-4 overflow-hidden mb-4">
                    <div class="card-header bg-success text-white py-3">
                        <h2 class="h4 mb-0 fw-bold">Neues Profil erstellen</h2>
                    </div>
                    <div class="card-body p-4">
                        <form th:action="@{/admin/create-profile}" method="post" class="row g-3">
                            <div class="col-md-6">
                                <label for="type" class="form-label">Profiltyp</label>
                                <select class="form-select" id="type" name="type" required>
                                    <option value="student" selected>Student</option>
                                    <option value="advisor">Advisor</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="githubLogin" class="form-label">GitHub Login</label>
                                <input type="text" class="form-control" id="githubLogin" name="githubLogin" required placeholder="GitHub Username">
                            </div>
                            <div class="col-md-6">
                                <label for="name" class="form-label">Name</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="col-md-6">
                                <label for="branch" class="form-label">Studiengang/Bereich</label>
                                <input type="text" class="form-control" id="branch" name="branch" required>
                            </div>
                            <div class="col-md-6">
                                <label for="birthday" class="form-label">Geburtsdatum</label>
                                <input type="date" class="form-control" id="birthday" name="birthday" required>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary">Profil erstellen</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
                    <div class="card-header bg-primary text-white py-3">
                        <h2 class="h4 mb-0 fw-bold">Ausstehende Betreuer-Anfragen</h2>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th class="ps-4">Benutzer</th>
                                        <th>Name</th>
                                        <th>Bereich</th>
                                        <th>Email</th>
                                        <th class="text-end pe-4">Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="request : ${pendingRequests}">
                                        <td class="ps-4">
                                            <div class="d-flex align-items-center">
                                                <img th:src="${request.avatarUrl}" class="rounded-circle me-3"
                                                    width="40" height="40" th:if="${request.avatarUrl}">
                                                <span class="fw-bold" th:text="${request.githubLogin}">Login</span>
                                            </div>
                                        </td>
                                        <td th:text="${request.name}">Name</td>
                                        <td th:text="${request.branch}">Bereich</td>
                                        <td th:text="${request.mail}">Email</td>
                                        <td class="text-end pe-4">
                                            <div class="d-flex justify-content-end gap-2">
                                                <form th:action="@{/admin/approve}" method="post">
                                                    <input type="hidden" name="login" th:value="${request.githubLogin}">
                                                    <button type="submit"
                                                        class="btn btn-sm btn-success px-3">Genehmigen</button>
                                                </form>
                                                <form th:action="@{/admin/reject}" method="post">
                                                    <input type="hidden" name="login" th:value="${request.githubLogin}">
                                                    <button type="submit"
                                                        class="btn btn-sm btn-outline-danger px-3">Ablehnen</button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr th:if="${#lists.isEmpty(pendingRequests)}">
                                        <td colspan="5" class="text-center py-5 text-muted italic">Keine ausstehenden
                                            Anfragen gefunden.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
</body>

</html>